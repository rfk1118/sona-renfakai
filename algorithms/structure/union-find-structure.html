<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>并查集 | 智慧不可赐！</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta name="description" content="因果不可改、智慧不可赐、真法不可说、无缘不能渡！">
    
    <link rel="preload" href="/assets/css/0.styles.7f49ab7e.css" as="style"><link rel="preload" href="/assets/js/app.d79ef973.js" as="script"><link rel="preload" href="/assets/js/2.cc934d9f.js" as="script"><link rel="preload" href="/assets/js/13.31228fa8.js" as="script"><link rel="prefetch" href="/assets/js/10.53ccf5a6.js"><link rel="prefetch" href="/assets/js/11.3907fa47.js"><link rel="prefetch" href="/assets/js/12.78791d1b.js"><link rel="prefetch" href="/assets/js/14.fad63996.js"><link rel="prefetch" href="/assets/js/15.446786de.js"><link rel="prefetch" href="/assets/js/16.7770fe0d.js"><link rel="prefetch" href="/assets/js/17.1330c391.js"><link rel="prefetch" href="/assets/js/18.a710e848.js"><link rel="prefetch" href="/assets/js/19.a8980e40.js"><link rel="prefetch" href="/assets/js/20.c120a181.js"><link rel="prefetch" href="/assets/js/21.57604bf8.js"><link rel="prefetch" href="/assets/js/22.9a4da823.js"><link rel="prefetch" href="/assets/js/23.8b6df68e.js"><link rel="prefetch" href="/assets/js/24.b45d118b.js"><link rel="prefetch" href="/assets/js/25.9f72385e.js"><link rel="prefetch" href="/assets/js/26.acf92556.js"><link rel="prefetch" href="/assets/js/27.8632e3b7.js"><link rel="prefetch" href="/assets/js/28.65a4f385.js"><link rel="prefetch" href="/assets/js/29.0bb14505.js"><link rel="prefetch" href="/assets/js/3.76282f7d.js"><link rel="prefetch" href="/assets/js/30.09b113a7.js"><link rel="prefetch" href="/assets/js/31.88f2aae4.js"><link rel="prefetch" href="/assets/js/32.ae12cb3e.js"><link rel="prefetch" href="/assets/js/33.ebda435d.js"><link rel="prefetch" href="/assets/js/34.18c5ff6a.js"><link rel="prefetch" href="/assets/js/35.0d83e936.js"><link rel="prefetch" href="/assets/js/36.958c9c4a.js"><link rel="prefetch" href="/assets/js/37.81749598.js"><link rel="prefetch" href="/assets/js/38.03f5e26e.js"><link rel="prefetch" href="/assets/js/39.29d28cbd.js"><link rel="prefetch" href="/assets/js/4.e254fa51.js"><link rel="prefetch" href="/assets/js/40.e5da55ae.js"><link rel="prefetch" href="/assets/js/41.c94ced0d.js"><link rel="prefetch" href="/assets/js/42.35ce7abc.js"><link rel="prefetch" href="/assets/js/43.668dc9dd.js"><link rel="prefetch" href="/assets/js/44.61b371a7.js"><link rel="prefetch" href="/assets/js/45.748d47d8.js"><link rel="prefetch" href="/assets/js/46.8b794660.js"><link rel="prefetch" href="/assets/js/47.965a5a96.js"><link rel="prefetch" href="/assets/js/48.f1ef9b23.js"><link rel="prefetch" href="/assets/js/49.f88489a6.js"><link rel="prefetch" href="/assets/js/5.0f8312c4.js"><link rel="prefetch" href="/assets/js/50.cef8b524.js"><link rel="prefetch" href="/assets/js/51.9d313409.js"><link rel="prefetch" href="/assets/js/52.b9028d78.js"><link rel="prefetch" href="/assets/js/53.37a1df79.js"><link rel="prefetch" href="/assets/js/54.0af71077.js"><link rel="prefetch" href="/assets/js/55.200dd0bd.js"><link rel="prefetch" href="/assets/js/56.ca100e52.js"><link rel="prefetch" href="/assets/js/57.fb080c68.js"><link rel="prefetch" href="/assets/js/58.dda93471.js"><link rel="prefetch" href="/assets/js/59.7091b307.js"><link rel="prefetch" href="/assets/js/6.f5a2c544.js"><link rel="prefetch" href="/assets/js/60.c785e25d.js"><link rel="prefetch" href="/assets/js/61.c0553f1d.js"><link rel="prefetch" href="/assets/js/62.c6828513.js"><link rel="prefetch" href="/assets/js/63.368e7f83.js"><link rel="prefetch" href="/assets/js/64.5742472a.js"><link rel="prefetch" href="/assets/js/65.008bb7c5.js"><link rel="prefetch" href="/assets/js/66.86c9023c.js"><link rel="prefetch" href="/assets/js/67.7629a6a7.js"><link rel="prefetch" href="/assets/js/68.ca685b9e.js"><link rel="prefetch" href="/assets/js/69.53a75a08.js"><link rel="prefetch" href="/assets/js/7.fc0334a0.js"><link rel="prefetch" href="/assets/js/70.d75b986e.js"><link rel="prefetch" href="/assets/js/71.131183de.js"><link rel="prefetch" href="/assets/js/72.7c0a31d8.js"><link rel="prefetch" href="/assets/js/73.a4c7f77e.js"><link rel="prefetch" href="/assets/js/74.91c5cb07.js"><link rel="prefetch" href="/assets/js/75.8c6bf485.js"><link rel="prefetch" href="/assets/js/76.7f90d4bb.js"><link rel="prefetch" href="/assets/js/77.a75f4e1d.js"><link rel="prefetch" href="/assets/js/78.d98cdaa9.js"><link rel="prefetch" href="/assets/js/79.58c676a6.js"><link rel="prefetch" href="/assets/js/8.531420eb.js"><link rel="prefetch" href="/assets/js/80.32145d03.js"><link rel="prefetch" href="/assets/js/81.18a45cef.js"><link rel="prefetch" href="/assets/js/82.4d290758.js"><link rel="prefetch" href="/assets/js/83.28878695.js"><link rel="prefetch" href="/assets/js/9.8ee008e1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7f49ab7e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">智慧不可赐！</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/introduction/about-me.html" class="sidebar-link">作者</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Netty</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>算法</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>排序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithms/sort/sort.html" class="sidebar-link">概念</a></li><li><a href="/algorithms/sort/bubble-sort.html" class="sidebar-link">冒泡排序</a></li><li><a href="/algorithms/sort/select-sort.html" class="sidebar-link">选择排序</a></li><li><a href="/algorithms/sort/insert-sort.html" class="sidebar-link">插入排序</a></li><li><a href="/algorithms/sort/merge-sort.html" class="sidebar-link">归并排序</a></li><li><a href="/algorithms/sort/quick-sort.html" class="sidebar-link">快速排序</a></li><li><a href="/algorithms/other/Edsger-Dijkstra.html" class="sidebar-link">荷兰国旗</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>数据结构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithms/structure/union-find-structure.html" aria-current="page" class="active sidebar-link">并查集</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#find-x" class="sidebar-link">Find(x)</a></li><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#union-x-y" class="sidebar-link">Union(x, y)</a></li><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#weighted-quick-union" class="sidebar-link">Weighted quick-union</a></li><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#path-compression" class="sidebar-link">Path Compression</a></li><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/algorithms/structure/union-find-structure.html#参考材料" class="sidebar-link">参考材料</a></li></ul></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Tree</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithms/tree/binary-tree-concept.html" class="sidebar-link">二叉树</a></li><li><a href="/algorithms/tree/pre-order.html" class="sidebar-link">前序遍历</a></li><li><a href="/algorithms/tree/binary-tree-algs4.html" class="sidebar-link">二叉树-算法4</a></li><li><a href="/algorithms/tree/balanced-search-trees.html" class="sidebar-link">2-3-搜索树</a></li><li><a href="/algorithms/heap/heap.html" class="sidebar-link">Heap</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>图</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithms/graphs/read-source.html" class="sidebar-link">导读</a></li><li><a href="/algorithms/graphs/graph-concept.html" class="sidebar-link">概念</a></li><li><a href="/algorithms/graphs/directed-graph.html" class="sidebar-link">有向图</a></li><li><a href="/algorithms/graphs/graph-search.html" class="sidebar-link">搜索</a></li><li><a href="/algorithms/graphs/minimum-spanning-tree.html" class="sidebar-link">最小生成树</a></li><li><a href="/algorithms/graphs/shortest-path-algnorithms.html" class="sidebar-link">最短路径算法</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Bit</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithms/bit/xor.html" class="sidebar-link">Xor</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithms/other/binary-Search.html" class="sidebar-link">二分查找法</a></li><li><a href="/algorithms/other/Top-down.html" class="sidebar-link">自顶而下</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程语言</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="并查集">并查集</h1> <h2 id="概念">概念</h2> <ul><li>用于存储不相交的集合</li> <li>可以高效支持两种操作
<ul><li><code>Find(x)</code>：返回 x 所属集合的“代表”</li> <li><code>Union(x, y)</code>: 合并包含 x 和 y 的两个集合</li></ul></li> <li>两种操作都可以在常量时间内完成</li> <li>简单实现</li> <li>主要思想：用有根树表示每个集合
<ul><li>每个节点都维护着一个到它的父节点的链接</li> <li>根节点是对应集合的“代表”</li> <li>例如: 两个集合<code>{x, y, z}</code> and <code>{a, b, c, d}</code> <img src="/assets/img/example-two-sets.9c8b2823.png" alt="An image"></li></ul></li></ul> <h3 id="代码实现">代码实现</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token class-name">Find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自己不是根节点，递归查找</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> x <span class="token operator">=</span> <span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">Union</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 直接连接</span>
    <span class="token class-name">L</span><span class="token punctuation">[</span><span class="token class-name">Find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="find-x">Find(x)</h2> <ol><li>跟随从 x 的连接直到一个节点指向自己，这可能需要 O(n) 时间，但我们会让它更快
<img src="/assets/img/quick-find-overview.1c75e2c9.png" alt="An image"></li> <li><a href="https://algs4.cs.princeton.edu/15uf/QuickFindUF.java.html" target="_blank" rel="noopener noreferrer">Quick-find<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，在查找时候直接返回<code>id[p]</code></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuickFindUF</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> id<span class="token punctuation">;</span>    <span class="token comment">// id[i] = component identifier of i</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>   <span class="token comment">// number of components</span>
    <span class="token comment">// 其他省略</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">validate</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> id<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">validate</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">validate</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> pID <span class="token operator">=</span> id<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// needed for correctness</span>
      <span class="token keyword">int</span> qID <span class="token operator">=</span> id<span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// to reduce the number of array accesses</span>

      <span class="token comment">// p and q are already in the same component</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>pID <span class="token operator">==</span> qID<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> id<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
          <span class="token comment">// 这里性能比较低，需要全部都修改</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>id<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> pID<span class="token punctuation">)</span> id<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> qID<span class="token punctuation">;</span>
      count<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="union-x-y">Union(x, y)</h2> <ol><li>运行 Find(x) 和 Find(y) 以找到对应的根节点并将一个指向另一个
<img src="/assets/img/quick-union-overview.40de1034.png" alt="An image"></li> <li><a href="https://algs4.cs.princeton.edu/15uf/QuickUnionUF.java.html" target="_blank" rel="noopener noreferrer">Quick-union<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuickUnionUF</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parent<span class="token punctuation">;</span>  <span class="token comment">// parent[i] = parent of i</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>     <span class="token comment">// number of components</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rootP <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> rootQ <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rootP <span class="token operator">==</span> rootQ<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token comment">// 这里只变更了一个节点，所以需要变更的是根节点</span>
    parent<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">=</span> rootQ<span class="token punctuation">;</span>
    count<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">validate</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span>
          p <span class="token operator">=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="weighted-quick-union">Weighted quick-union</h2> <ol><li>主要是将小子树挂到大子树上面
<img src="/assets/img/weighted-quick-union-overview.35b8b898.png" alt="An image"></li> <li><a href="https://algs4.cs.princeton.edu/15uf/WeightedQuickUnionUF.java.html" target="_blank" rel="noopener noreferrer">代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>实现</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeightedQuickUnionUF</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parent<span class="token punctuation">;</span>   <span class="token comment">// parent[i] = parent of i</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> size<span class="token punctuation">;</span>     <span class="token comment">// size[i] = number of elements in subtree rooted at i</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>      <span class="token comment">// number of components</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">validate</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span>
        p <span class="token operator">=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> p<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rootP <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> rootQ <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rootP <span class="token operator">==</span> rootQ<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token comment">// 让小节点挂在到大节点上</span>
    <span class="token comment">// make smaller root point to larger one</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>size<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">&lt;</span> size<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parent<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">=</span> rootQ<span class="token punctuation">;</span>
        size<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span> <span class="token operator">+=</span> size<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        parent<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span> <span class="token operator">=</span> rootP<span class="token punctuation">;</span>
        size<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">+=</span> size<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    count<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="path-compression">Path Compression</h2> <ul><li>在糟糕的情况下，树可能会变得太深
<ul><li>这会减慢未来的运行速度</li></ul></li> <li>每次调用<code>Find()</code> 时，路径压缩都会使树变浅</li> <li>只要根保持不变，我们不在乎树的样子
<ul><li><code>Find(x)</code>返回根后，回溯到 x 并将所有链接重新路由到根</li></ul></li></ul> <h3 id="path-compression实现">Path-Compression实现</h3> <p>我们将假设链接存储在 L[]</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token class-name">Find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> x<span class="token punctuation">;</span>
    <span class="token keyword">int</span> root <span class="token operator">=</span> <span class="token class-name">Find</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 路径压缩</span>
    <span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> root<span class="token punctuation">;</span>
    <span class="token keyword">return</span> root<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token class-name">Find</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">==</span> <span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">?</span> x <span class="token operator">:</span> <span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Find</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="java代码下载">Java代码下载</h3> <ul><li>下载<a href="https://algs4.cs.princeton.edu/code/" target="_blank" rel="noopener noreferrer">算法4 jar包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://algs4.cs.princeton.edu/code/edu/princeton/cs/algs4/UF.java.html" target="_blank" rel="noopener noreferrer">UF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><a href="https://mvnrepository.com/artifact/edu.princeton.cs/algs4/1.0.4" target="_blank" rel="noopener noreferrer">maven下载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mvnrepository<span class="token punctuation">.</span>com<span class="token operator">/</span>artifact<span class="token operator">/</span>edu<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>cs<span class="token operator">/</span>algs4 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>edu<span class="token punctuation">.</span>princeton<span class="token punctuation">.</span>cs<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>algs4<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.0</span><span class="token number">.4</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre></div><h4 id="通用代码">通用代码</h4> <ol><li>设计数据结构</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> UF <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parent<span class="token punctuation">;</span>  <span class="token comment">// parent[i] = parent of i</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rank<span class="token punctuation">;</span>   <span class="token comment">// rank[i] = rank of subtree rooted at i (never more than 31)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>初始化数据</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token function">UF</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    count <span class="token operator">=</span> n<span class="token punctuation">;</span>
    parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    rank <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自己指向自己</span>
        parent<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
        rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>可以忽略不重要代码</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 判断索引</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> parent<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> p <span class="token operator">&gt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;index &quot;</span> <span class="token operator">+</span> p <span class="token operator">+</span> <span class="token string">&quot; is not between 0 and &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="find-x-代码">Find(x)代码</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* Returns the component identifier for the component containing site {@code p}.
*
* @param  p the integer representing one site
* @return the component identifier for the component containing site {@code p}
* @throws IllegalArgumentException unless {@code 0 &lt;= p &lt; n}
*/</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 校验索引</span>
  <span class="token function">validate</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 如果当前元素的父亲不是自己，继续查找</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 路径压缩</span>
      parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> parent<span class="token punctuation">[</span>parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">// path compression by halving</span>
      p <span class="token operator">=</span> parent<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 找到了根节点</span>
  <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="union-x-y-代码">Union(x, y)代码</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* Merges the component containing site {@code p} with the
* the component containing site {@code q}.
*
* @param  p the integer representing one site
* @param  q the integer representing the other site
* @throws IllegalArgumentException unless
*         both {@code 0 &lt;= p &lt; n} and {@code 0 &lt;= q &lt; n}
*/</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">union</span><span class="token punctuation">(</span><span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 查找p的根</span>
  <span class="token keyword">int</span> rootP <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 查找q的根</span>
  <span class="token keyword">int</span> rootQ <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 如果相等，已经连接过了</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>rootP <span class="token operator">==</span> rootQ<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token comment">// 集合数量多的不变，少的将父亲指向多的</span>
  <span class="token comment">// make root of smaller rank point to root of larger rank</span>
  <span class="token keyword">if</span>      <span class="token punctuation">(</span>rank<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">&lt;</span> rank<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span><span class="token punctuation">)</span> parent<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">=</span> rootQ<span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rank<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">&gt;</span> rank<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span><span class="token punctuation">)</span> parent<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span> <span class="token operator">=</span> rootP<span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 子树数量相等</span>
      parent<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span> <span class="token operator">=</span> rootP<span class="token punctuation">;</span>
      <span class="token comment">// 等级+1</span>
      rank<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 集合数量减1</span>
  count<span class="token operator">--</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="go实现"><a href="https://github.com/sona0402/leetcode/blob/master/src/structure/UF.go" target="_blank" rel="noopener noreferrer">Go实现<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <ol><li>创建数据结构</li></ol> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> UF <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  parent<span class="token punctuation">,</span> rank <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
  nComponents  <span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>初始化数据结构</li></ol> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">newUF</span><span class="token punctuation">(</span>initSize <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>UF <span class="token punctuation">{</span>
  <span class="token comment">// 初始化数据结构</span>
  uf <span class="token operator">:=</span> <span class="token operator">&amp;</span>UF<span class="token punctuation">{</span>
    parent<span class="token punctuation">:</span>      <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> initSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
    rank<span class="token punctuation">:</span>        <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> initSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
    nComponents<span class="token punctuation">:</span> initSize<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 子树等级初始化</span>
  <span class="token keyword">for</span> index <span class="token operator">:=</span> <span class="token keyword">range</span> uf<span class="token punctuation">.</span>rank <span class="token punctuation">{</span>
    uf<span class="token punctuation">.</span>rank<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 自己的父亲指向自己</span>
  <span class="token keyword">for</span> index <span class="token operator">:=</span> <span class="token keyword">range</span> uf<span class="token punctuation">.</span>parent <span class="token punctuation">{</span>
    uf<span class="token punctuation">.</span>rank<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> index
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> uf
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>Find(x)</li></ol> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>uf <span class="token operator">*</span>UF<span class="token punctuation">)</span> <span class="token function">find</span><span class="token punctuation">(</span>item <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> item <span class="token operator">!=</span> uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token comment">// 路径压缩</span>
    uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment">// 向上走</span>
    item <span class="token operator">=</span> uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> item
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li>Union(x, y)</li></ol> <div class="language-Go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>uf <span class="token operator">*</span>UF<span class="token punctuation">)</span> <span class="token function">merge</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 查找p的根</span>
  rootP <span class="token operator">:=</span> uf<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
  <span class="token comment">// 查找q的根</span>
  rootQ <span class="token operator">:=</span> uf<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
  <span class="token comment">// 已经在一个集合里面了</span>
  <span class="token keyword">if</span> rootQ <span class="token operator">==</span> rootP <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  subTreeP <span class="token operator">:=</span> uf<span class="token punctuation">.</span>rank<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span>
  subTreeQ <span class="token operator">:=</span> uf<span class="token punctuation">.</span>rank<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span>
  <span class="token keyword">if</span> subTreeP <span class="token operator">&lt;</span> subTreeQ <span class="token punctuation">{</span>
    uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span> <span class="token operator">=</span> rootQ
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> subTreeP <span class="token operator">&gt;</span> subTreeQ <span class="token punctuation">{</span>
    uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span> <span class="token operator">=</span> rootP
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 子树等级相同，使用那个都行</span>
    <span class="token comment">// uf.parent[rootP]  = rootQ</span>
    <span class="token comment">// uf.parent[rootQ]  = rootP</span>
    uf<span class="token punctuation">.</span>parent<span class="token punctuation">[</span>rootQ<span class="token punctuation">]</span> <span class="token operator">=</span> rootP
    uf<span class="token punctuation">.</span>rank<span class="token punctuation">[</span>rootP<span class="token punctuation">]</span><span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 集合个数减少一个</span>
  uf<span class="token punctuation">.</span>nComponents<span class="token operator">--</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="总结">总结</h2> <ul><li>核心思想为树，查找根节点</li> <li>使用位运算也可以进行处理，例如<a href="https://book.douban.com/subject/27044219/" target="_blank" rel="noopener noreferrer">Go程序设计语言 6.5 位向量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://github.com/sona0402/go-study/blob/dev/ch06/intset/intset.go" target="_blank" rel="noopener noreferrer">代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="参考材料">参考材料</h2> <ul><li><a href="https://algs4.cs.princeton.edu/15uf/" target="_blank" rel="noopener noreferrer">《算法4》 Union-Find<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://book.douban.com/subject/20432061/" target="_blank" rel="noopener noreferrer">《算法导论》 21章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://book.douban.com/subject/27044219/" target="_blank" rel="noopener noreferrer">《Go程序设计语言》 6.5 位向量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://web.stanford.edu/class/cs97si/03-data-structures.pdf" target="_blank" rel="noopener noreferrer">CS 97SI-Data Structures<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.youtube.com/watch?v=RBSGKlAvoiM" target="_blank" rel="noopener noreferrer">Data Structures Easy to Advanced Course - Full Tutorial from a Google Engineer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/algorithms/other/Edsger-Dijkstra.html" class="prev">
        荷兰国旗
      </a></span> <span class="next"><a href="/algorithms/tree/binary-tree-concept.html">
        二叉树
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.d79ef973.js" defer></script><script src="/assets/js/2.cc934d9f.js" defer></script><script src="/assets/js/13.31228fa8.js" defer></script>
  </body>
</html>
